<p>Hello, this is the settings page</p>

<input id="name" />
<input id="age" />
<button id="save">Save</button>
<button id="reset">Reset</button>

<p id="msg"></p>

<script>
	const { invoke } = window.__TAURI__.tauri;

	const msg = document.getElementById("msg");

	async function getConfig() {
		return await invoke("get_config", {});
	}

	const config = getConfig().then(c => {
		for (let key in c) {
			const el = document.getElementById(key);
			if (el) el.value = c[key];
		}
	});

	const saveBtn = document.getElementById("save");
	saveBtn.addEventListener("click", async () => {
		const name = document.getElementById("name").value;
		const age = document.getElementById("age").value;

		invoke("write_config", {
			config: {
				initialised: true,
				name: name,
				age: Number(age),
			},
		});

		msg.innerText = "Saved!";
	});

	const resetBtn = document.getElementById("reset");
	resetBtn.addEventListener("click", async () => {
		await invoke("delete_config", {});
		window.location = "/pages/wizard.html";
		msg.innerText = "Reset!";
	});
</script>
